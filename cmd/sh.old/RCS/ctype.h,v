head     0.4;
access   ;
symbols  MNOS:0.3 SYSTEM2_9:0.2 DEMOS1_3:0.1;
locks    ;
comment  @ * @;


0.4
date     86.09.29.18.26.03;  author alex;  state Exp;
branches ;
next     0.3;

0.3
date     86.09.24.21.50.32;  author alex;  state Exp;
branches ;
next     0.2;

0.2
date     86.09.24.21.38.39;  author alex;  state Exp;
branches ;
next     0.1;

0.1
date     86.09.24.21.25.41;  author alex;  state Exp;
branches ;
next     ;


desc
@SHELL -интерпретатор
@


0.4
log
@Версия, слитая из 2.9 и ДЕМОС без русских диагностик
@
text
@#
/*
 *	 KIAE  shell
 */


/* table 1 */
#define T_SUB	01
#define T_MET	02
#define	T_SPC	04
#define T_DIP	010
#define T_EOF	020
#define T_EOR	040
#define T_QOT	0100
#define T_ESC	0200

/* table 2 */
#define T_BRC	01
#define T_DEF	02
#define T_AST	04
#define	T_DIG	010
#define T_FNG	020
#define T_SHN	040
#define	T_IDC	0100
#define T_SET	0200

/* for single chars */
#define _TAB	(T_SPC)
#define _SPC	(T_SPC)
#define _UPC	(T_IDC)
#define _LPC	(T_IDC)
#define _DIG	(T_DIG)
#define _EOF	(T_EOF)
#define _EOR	(T_EOR)
#define _BAR	(T_DIP)
#define _HAT	(T_MET)
#define _BRA	(T_MET)
#define _KET	(T_MET)
#define _SQB	(T_FNG)
#define _AMP	(T_DIP)
#define _SEM	(T_DIP)
#define _LT	(T_DIP)
#define _GT	(T_DIP)
#define _LQU	(T_QOT|T_ESC)
#define _BSL	(T_ESC)
#define _DQU	(T_QOT)
#define _DOL1	(T_SUB|T_ESC)

#define _CBR	T_BRC
#define _CKT	T_DEF
#define _AST	(T_AST|T_FNG)
#define _EQ	(T_DEF)
#define _MIN	(T_DEF|T_SHN)
#define _PCS	(T_SHN)
#define _NUM	(T_SHN)
#define _DOL2	(T_SHN)
#define _PLS	(T_DEF|T_SET)
#define _AT	(T_AST)
#define _QU	(T_DEF|T_FNG|T_SHN)

/* abbreviations for tests */
#define _IDCH	(T_IDC|T_DIG)
#define _META	(T_SPC|T_DIP|T_MET|T_EOR)

char	_ctype1[];

/* nb these args are not call by value !!!! */
#define	space(c)	(((c)&QUOTE)==0 ANDF _ctype1[c]&(T_SPC))
#define eofmeta(c)	(((c)&QUOTE)==0 ANDF _ctype1[c]&(_META|T_EOF))
#define qotchar(c)	(((c)&QUOTE)==0 ANDF _ctype1[c]&(T_QOT))
#define eolchar(c)	(((c)&QUOTE)==0 ANDF _ctype1[c]&(T_EOR|T_EOF))
#define dipchar(c)	(((c)&QUOTE)==0 ANDF _ctype1[c]&(T_DIP))
#define subchar(c)	(((c)&QUOTE)==0 ANDF _ctype1[c]&(T_SUB|T_QOT))
#define escchar(c)	(((c)&QUOTE)==0 ANDF _ctype1[c]&(T_ESC))

char	_ctype2[];

#define	digit(c)	(((c)&QUOTE)==0 ANDF _ctype2[c]&(T_DIG))
#define fngchar(c)	(((c)&QUOTE)==0 ANDF _ctype2[c]&(T_FNG))
#define dolchar(c)      ( _ctype2[cii(c)]&(T_AST|T_BRC|T_DIG|T_IDC|T_SHN))
#define defchar(c)	(((c)&QUOTE)==0 ANDF _ctype2[c]&(T_DEF))
#define setchar(c)	(((c)&QUOTE)==0 ANDF _ctype2[c]&(T_SET))
#define digchar(c)	(((c)&QUOTE)==0 ANDF _ctype2[c]&(T_AST|T_DIG))
#define letter(c)       ( _ctype2[cii(c)]&(T_IDC))
#define alphanum(c)     ( _ctype2[cii(c)]&(_IDCH))
#define astchar(c)	(((c)&QUOTE)==0 ANDF _ctype2[c]&(T_AST))

char    _ctype3[];
char    cj;

#define qmask(c)  (cj=(c),(  (cj&0200) ||(_ctype3[cj]) ==0)? cj : _ctype3[cj])
#define smask(c)  (cj=(c),cj=QST(cj),((!(cj&0200))||(_ctype3[cii(cj)]) ==0)? cj : _ctype3[cii(cj)])
#define ismask(c) (cii(smask(c)))

#define QST(c)    (((c & 0177) == 0) ? 0 : c)
#define isq(q)    ( ((q) &0300) == 0200 )
#define cii(c)    (((int) (c))&0377)
@


0.3
log
@Версия из МНОС
@
text
@d3 1
a3 3
 *	МНОС РЛ 1.2 shell
 *
 *
d96 1
a96 1
#define isq(q)    ( (((q) >> 6)&03) == 02 )
@


0.2
log
@Версия из 2.9
@
text
@d3 1
a3 1
 *	UNIX shell
a4 2
 *	S. R. Bourne
 *	Bell Telephone Laboratories
d82 1
a82 1
#define dolchar(c)	(((c)&QUOTE)==0 ANDF _ctype2[c]&(T_AST|T_BRC|T_DIG|T_IDC|T_SHN))
d86 2
a87 2
#define	letter(c)	(((c)&QUOTE)==0 ANDF _ctype2[c]&(T_IDC))
#define alphanum(c)	(((c)&QUOTE)==0 ANDF _ctype2[c]&(_IDCH))
d89 11
@


0.1
log
@Версия из ДЕМОС 1.3
@
text
@d3 5
a7 1
 *	 KIAE  shell
d84 1
a84 1
#define dolchar(c)      ( _ctype2[cii(c)]&(T_AST|T_BRC|T_DIG|T_IDC|T_SHN))
d88 2
a89 2
#define letter(c)       ( _ctype2[cii(c)]&(T_IDC))
#define alphanum(c)     ( _ctype2[cii(c)]&(_IDCH))
a90 11

char    _ctype3[];
char    cj;

#define qmask(c)  (cj=(c),(  (cj&0200) ||(_ctype3[cj]) ==0)? cj : _ctype3[cj])
#define smask(c)  (cj=(c),cj=QST(cj),((!(cj&0200))||(_ctype3[cii(cj)]) ==0)? cj : _ctype3[cii(cj)])
#define ismask(c) (cii(smask(c)))

#define QST(c)    (((c & 0177) == 0) ? 0 : c)
#define isq(q)    ( ((q) &0300) == 0200 )
#define cii(c)    (((int) (c))&0377)
@
