
TOPEN(3F)     ДЕМОС. Руководство программиста      TOPEN(3F)


ИИММЯЯ
       ttooppeenn, ttcclloossee, ttrreeaadd, ttwwrriittee, ttrreewwiinn, ttsskkiippff,  ttssttaattee
       - работа с МЛ из программ на Фортране-77.

ФФООРРММААТТ
       iinntteeggeerr ffuunnccttiioonn ttooppeenn(_t_l_u, _d_e_v_n_a_m, _l_a_b_e_l)
       iinntteeggeerr _t_l_u
       cchhaarraacctteerr*(*) _d_e_v_n_a_m
       llooggiiccaall _l_a_b_e_l

       iinntteeggeerr ffuunnccttiioonn ttcclloossee(_t_l_u)
       iinntteeggeerr _t_l_u

       iinntteeggeerr ffuunnccttiioonn ttrreeaadd(_t_l_u, _b_u_f_f_e_r)
       iinntteeggeerr _t_l_u
       cchhaarraacctteerr*(*) _b_u_f_f_e_r

       iinntteeggeerr ffuunnccttiioonn ttwwrriittee(_t_l_u, _b_u_f_f_e_r)
       iinntteeggeerr _t_l_u
       cchhaarraacctteerr*(*) _b_u_f_f_e_r

       iinntteeggeerr ffuunnccttiioonn ttrreewwiinn(_t_l_u)
       iinntteeggeerr _t_l_u

       iinntteeggeerr ffuunnccttiioonn ttsskkiippff(_t_l_u, _n_f_i_l_e_s, _n_r_e_c_s)
       iinntteeggeerr _t_l_u, _n_f_i_l_e_s, _n_r_e_c_s

       iinntteeggeerr ffuunnccttiioonn ttssttaattee(_t_l_u, _f_i_l_e_n_o, _r_e_c_n_o,
               _e_r_r_f, _e_o_f_f, _e_o_t_f, _t_c_s_r)
       iinntteeggeerr _t_l_u, _f_i_l_e_n_o, _r_e_c_n_o, _t_c_s_r
       llooggiiccaall _e_r_r_f, _e_o_f_f, _e_o_t_f

ООППИИССААННИИЕЕ
       Эти функции обеспечивают интерфейс программ на  языке
       Фортран-77 для работы с магнитными лентами.

       Во всех функциях лента выступает под своим  "логичес-
       ким  номером  ленты" _t_l_u.  Связь логического номера и
       именем устройства устанавливается с  помощью  функции
       ttooppeenn,  аналогично  ooppeenn для остальных файлов.  Логи-
       ческий номер ленты _t_l_u должен являться целым  положи-
       тельным числом в диапазоне от 0 до 3.  Аргумент _l_a_b_e_l
       функции ttooppeenn указывает  на  наличие  или  отсутствие
       метки  тома  (эта  информация  учитывается при работе
       функции ttrreewwiinn).   Выполнение  ttooppeenn  не  приводит  к
       перемотке  ленты  на начало.  Если операция выполнена
       успешно, возвращается значение 0, в противном  случае
       выдается  отрицательное  значение  и  код ошибки (см.
       _p_e_r_r_o_r(3f)).

       Функця ttcclloossee закрывает логический  канал  и  удаляет
       связь  с  _t_l_u.   Отрицательное  значение указывает на
       ошибку.

       Функция  ttrreeaadd  переписывает   очередную   физическую
       запись  с ленты в байтный массив _b_u_f_f_e_r.  Размер мас-
       сива _b_u_f_f_e_r должен быть  достаточным  для  размещения
       самой  большой  из  читаемых  физических  записей.  В


                            -1-                     ДЕМОС/PV


TOPEN(3F)     ДЕМОС. Руководство программиста      TOPEN(3F)


       качестве значения функции выдается число реально про-
       читанных  байтов.  Если значение равно 0 - это свиде-
       тельствует, что обнаружен конец файла.  Отрицательное
       значение указывает на ошибку.

       Функция ttwwrriittee  переписывает  информацию  из  массива
       _b_u_f_f_e_r  на магнитную ленту, при этом образуется новая
       физическая запись.  Длина записи  будет  соответство-
       вать размеру _b_u_f_f_e_r.  В качестве кода ответа выдается
       число записанных байт.  При ошибке функция возвращает
       отрицательное или нулевое значение.

       Функция ttrreewwiinn перематывает ленту, связанную с _t_l_u, к
       началу  файла.   Если  лента  помечена  (при открытии
       задан параметр _l_a_b_e_l = .ttrruuee.),  пропускается  метка.
       При  успешном  завершении  возвращается значение 0, в
       противном случае выдается отрицательное число.

       Функция ttsskkiippff позволяет пропускать файлы  и  записи.
       Аргумент   _n_f_i_l_e_s  указывает  число  признаков  конца
       файла, а _n_r_e_c_s - число  физических  записей,  которые
       необходимо пропустить.  При успешном завершении возв-
       ращается значение  0,  в  противном  случае  выдается
       отрицательное число.

       Последняя функция -  ttssttaattee  -  позволяет  опрашивать
       состояние  канала ввода/вывода и посмотреть состояние
       регистра драйвера управления лентой.  Значения _f_i_l_e_n_o
       и   _r_e_c_n_o  соответствуют  номерам  текущего  файла  и
       записи.  Логические величины _e_r_r_f, _e_o_f_f и _e_o_t_f указы-
       вают: на ошибку операции (_e_r_r_f), выход на конец теку-
       щего файла (_e_o_f_f), или на достижение конца информации
       на  ленте  (_e_o_t_f).  Признак конца информации на ленте
       (EEOOTT) обозначается двумя последовательными признаками
       конца  файла.   Значение переменной _t_c_s_r содержит код
       состояния контроллера МЛ (см.  _m_t(4)).

ФФААЙЙЛЛЫЫ
       /_u_s_r/_l_i_b/_l_i_b_U_7_7._a

ДДООППООЛЛННИИТТЕЕЛЛЬЬННЫЫЕЕ ССССЫЫЛЛККИИ
       _t_m(4), _p_e_r_r_o_r(3f), _m_t(1)


















                            -2-                     ДЕМОС/PV

