
MALLOC(3)       ДЕМОС. Библиотечные функции        MALLOC(3)


ИИММЯЯ
       mmaalllloocc, ffrreeee, rreeaalllloocc, ccaalllloocc - распределение памяти.

ФФООРРММААТТ
              cchhaarr *mmaalllloocc(_s_i_z_e)
              iinntt _s_i_z_e;

              ffrreeee(_p_t_r)
              cchhaarr *_p_t_r;

              cchhaarr *rreeaalllloocc(_p_t_r, _s_i_z_e)
              cchhaarr *_p_t_r;
              iinntt _s_i_z_e;

              cchhaarr *ccaalllloocc(_n_e_l_e_m, _e_l_s_i_z_e)
              iinntt _n_e_l_e_m, _e_l_s_i_z_e;

ООППИИССААННИИЕЕ
       Функции mmaalllloocc и ffrreeee обеспечивают  простое  средство
       распределения  памяти. Функция mmaalllloocc возвращает ука-
       затель на блок не менее _s_i_z_e байтов длиной,  начинаю-
       щийся на границе слова.

       Аргументом _f_r_e_e является  указатель  на  блок,  ранее
       распределенный  с  помощью  _m_a_l_l_o_c; эта память стано-
       вится доступной для последующего распределения, но ее
       содержимое не портится.

       Совершенно понятно, что к фатальным ошибкам  приведут
       чрезмерные запросы памяти по mmaalllloocc или использование
       в  качестве  аргумента  _f_r_e_e   произвольных   объемов
       памяти.

       Функция mmaalllloocc распределяет первое достаточно большое
       непрерывное  поле из свободного пространства, обнару-
       живаемого в процессе циклического поиска  от  послед-
       него  размещенного или освобожденного блока; при этом
       объединяются смежные свободные блоки. Функция  mmaalllloocc
       вызывает  ssbbrrkk (см.  _b_r_k(2)), чтобы получить дополни-
       тельную память у системы, когда больше нет  доступной
       свободной памяти.

       Функция rreeaalllloocc изменяет  размер  блока,  на  который
       указывает _p_t_r, на _s_i_z_e байтов, и возвращает указатель
       на блок (возможно, сдвинутый).  Не  будет  изменяться
       содержимое до меньшего из нового и старого размеров.

       Функция rreeaalllloocc работает так же, если  _p_t_r  указывает
       на  блок,  освобожденный  с момента последнего вызова
       mmaalllloocc, rreeaalllloocc или ccaalllloocc; таким образом, последова-
       тельность  ffrreeee,  mmaalllloocc и rreeaalllloocc позволяет реализо-
       вать стратегию поиска mmaalllloocc, обеспечивающую компакт-
       ное использование памяти.

       Функция ccaalllloocc выделяет память для массива,  имеющего
       _n_e_l_e_m  элементов,  размер  каждого из которых _e_l_s_i_z_e.
       Эта память заполняется вначале нулями.



                            -1-                     ДЕМОС/PV


MALLOC(3)       ДЕМОС. Библиотечные функции        MALLOC(3)


       Каждая из программ  распределения  памяти  возвращает
       указатель  на  поле,  необходимым образом выравненное
       для объекта любого типа.

ДДИИААГГННООССТТИИККАА
       Функции mmaalllloocc, rreeaalllloocc и ccaalllloocc  возвращают  нулевой
       указатель  (NNUULLLL), если нет доступной памяти или если
       область была запорчена путем записи за границы блока.
       mmaalllloocc можно перекомпилировать с целью получения воз-
       можности проверять область действия очень строго и по
       каждому виду операций.

ЗЗААММЕЕЧЧААННИИЯЯ
       Когда rreeaalllloocc возвращает нуль, блок, на который  ука-
       зывает _p_t_r, может быть разрушен.













































                            -2-                     ДЕМОС/PV

