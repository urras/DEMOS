
SEMCTL(2)         ДЕМОС. Системные вызовы          SEMCTL(2)


ИИММЯЯ
       sseemmccttll - изменение параметров группы семафоров.

ФФООРРММААТТ
       #iinncclluuddee <_s_y_s/_t_y_p_e_s._h>
       #iinncclluuddee <_s_y_s/_i_p_c._h>
       #iinncclluuddee <_s_y_s/_s_e_m._h>

       sseemmccttll( _i_d, _n_u_m, _c_m_d, _a_r_g )
       iinntt _i_d, _n_u_m, _c_m_d;
       uunniioonn sseemmuunniioonn {
               iinntt vvaall;
               ssttrruucctt sseemmiidd__ddss *bbuuff;
               uu__sshhoorrtt *aarrrraayy;
       } _a_r_g;

ООППИИССААННИИЕЕ
       Системный вызов sseemmccttll  выполняет  указанную  команду
       _c_m_d  над  группой  семафоров  с  идентификатором  _i_d.
       Отрабатываются следующие команды:

       GGEETTVVAALL Возвращает значение семафора с индексом _n_u_m  в
              группе.

       SSEETTVVAALL Устанавливает значение семафора с индексом _n_u_m
              равным _a_r_g._v_a_l.

       GGEETTPPIIDD Возвращает  идентификатор  процесса,   который
              последним выполнял операцию sseemmoopp((22)) над сема-
              фором с индексом _n_u_m.

       GGEETTNNCCNNTT
              Возвращает  количество  процессов,   ожидающих
              события "семафор _n_u_m больше нуля".

       GGEETTZZCCNNTT
              Возвращает  количество  процессов,   ожидающих
              события "семафор _n_u_m равен нулю".

       GGEETTAALLLL Записывает значения всех  семафоров  группы  в
              массив целых _a_r_g._a_r_r_a_y

       SSEETTAALLLL Загружает значения всех  семафоров  группы  из
              массива _a_r_g._a_r_r_a_y

       IIPPCC__SSTTAATT
              Читает заголовок группы семафоров в  структуру
              _a_r_g._b_u_f

       IIPPCC__SSEETT
              Устанавливает поля sseemm__ppeerrmm..uuiidd,  sseemm__ppeerrmm..ggiidd
              и  sseemm__ppeerrmm..mmooddee  (только 9 младших бит - коды
              доступа) из структуры _a_r_g._b_u_f

       IIPPCC__RRMMIIDD
              Удаляет группу  семафоров  _i_d,  продолжив  все
              процессы,  остановленные перед семафорами этой
              группы.


                            -1-                      ДЕМОС/P


SEMCTL(2)         ДЕМОС. Системные вызовы          SEMCTL(2)


       Параметр _n_u_m указывает  количество  семафоров  группы
       или номер семафора, которые должны быть обработаны.

       Структура sseemmiidd__ddss определена так:

       ssttrruucctt sseemmiidd__ddss {
         ssttrruucctt iippcc__ppeerrmm  sseemm__ppeerrmm;  /* права доступа */
         ssttrruucctt sseemm *sseemm__bbaassee;
         uu__sshhoorrtt sseemm__nnsseemmss; /* количество семафоров в группе */
         ttiimmee__tt  sseemm__oottiimmee; /* время посл. sseemmoopp-а */
         ttiimmee__tt  sseemm__ccttiimmee; /* время посл. изменения доступа */
       };

       Структура iippcc__ppeerrmm определена так:

       ssttrruucctt iippcc__ppeerrmm {
           uu__sshhoorrtt  uuiidd;  /* текущий ид-р пользователя */
           uu__sshhoorrtt  ggiidd;  /* текущая группа пользователя */
           uu__sshhoorrtt  ccuuiidd; /* идентификатор создателя */
           uu__sshhoorrtt  ccggiidd; /* группа создателя */
           uu__sshhoorrtt  mmooddee; /* коды доступа */
           uu__sshhoorrtt  sseeqq;  /* используется системой */
           kkeeyy__tt    kkeeyy;  /* ключ ресурса */
       };

ККООДДЫЫ ООШШИИББООКК
       При ошибке системный вызов возвращает значение  -1  и
       код ошибки в переменной eerrrrnnoo.

       [[EENNOOEENNTT]]    Группы с идентификатором  _i_d  не  сущест-
                   вует.

       [[EEAACCCCEESS]]    Не имеете права доступа к группе  семафо-
                   ров.

       [[EEFFAAUULLTT]]    В качестве аргумента указан адрес,  лежа-
                   щий вне адресного простанства процесса.

       [[EEIINNVVAALL]]    Указан индекс семафора, превышающий  раз-
                   мер группы.

       [[EERRAANNGGEE]]    При  операции  SSEETT  значение  какого-либо
                   семафора   будет   превышать  максимально
                   допустимое.

ДДООППООЛЛННИИТТЕЕЛЛЬЬННЫЫЕЕ ССССЫЫЛЛККИИ
       _s_e_m_g_e_t(2), _s_e_m_o_p(2).













                            -2-                      ДЕМОС/P

