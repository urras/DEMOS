
OPEN(2)           ДЕМОС. Системные вызовы            OPEN(2)


ИИММЯЯ
       ooppeenn - открыть файл.

ФФООРРММААТТ
       #iinncclluuddee <_s_y_s/_f_c_n_t_l._h>

       ooppeenn( _n_a_m_e, _f_l_a_g_s [, _m_o_d_e] )
       cchhaarr *_n_a_m_e;
       iinntt _f_l_a_g_s, _m_o_d_e;

ООППИИССААННИИЕЕ
       Системный вызов ooppeenn открывает файл _n_a_m_e  для  чтения
       и/или записи и возвращает дескриптор открытого файла.
       Параметр _f_l_a_g_s задает  режимы  открытия  файла.  Если
       задан  режим создания файла (OO__CCRREEAATTEE), то надо пере-
       дать третий параметр _m_o_d_e, в котором указываются моды
       для создания нового файла.

       Режимы открытия файла подразделяются  на  основные  и
       дополнительные.   Обязательно должен быть указан один
       (только один) из  основных  режимов.   Дополнительные
       режимы  могут  комбинироваться с основными и являются
       необязательными. Комбинация режимов выполняется логи-
       ческим сложением значений требуемых режимов.

       Основные режимы:

       OO__RRDDOONNLLYY (0) Открыть только для чтения.

       OO__WWRROONNLLYY (01) Открыть только для записи.

       OO__RRDDWWRR   (02) Открыть для чтения и записи.

       Дополнительные режимы, которые используются не только
       при  открытии, но и при последующих системных вызовах
       с этим файлом:

       OO__NNDDEELLAAYY (04) Установка режима без ожидания. При отк-
                рытии  означает следующее.  Если открывается
                FFIIFFOO файл и он не  открыт  с  другого  конца
                (т.е.  если открываем на запись и он не отк-
                рыт на чтение, и наоборот), то не  ожидается
                открытия  с другого конца и происходит возв-
                рат с  ошибкой  [[EENNXXIIOO]].  Если  не  задается
                режим  OO__NNDDEELLAAYY, то во время операции откры-
                тия FFIIFFOO файла ожидается открытие с  другого
                конца.   Значение  этого  флага для операций
                чтения/записи описано в  статьях  _r_e_a_d(2)  и
                _w_r_i_t_e(2)  (имеет  смысл только для FFIIFFOO фай-
                лов).

       OO__AAPPPPEENNDD (010) Запись в конец  файла.  При  операциях
                записи указатель перед операцией, независимо
                от текущего значения, всегда будет  устанав-
                ливаться в конец файла.

       OO__SSYYNNCC   (020) Синхронный обмен. Все операции  записи
                будут     ожидать     конца    действительно


                            -1-                      ДЕМОС/P


OPEN(2)           ДЕМОС. Системные вызовы            OPEN(2)


                произведенной записи.

       Режимы этой группы могут изменяться вызовом _f_c_n_t_l(2).

       Дополнительные режимы,  которые  используются  только
       при открытии файла:

       OO__CCRREEAATT  (0400) Создать файл, если его  нет.  В  этом
                случае используется третий параметр _m_o_d_e для
                указания кодов доступа файла (см. _c_r_e_a_t(2)).

       OO__TTRRUUNNCC  (01000) Обнулить  файл  при  открытии.  Т.е.
                уничтожается  все  содержимое  существующего
                файла,  и  его  длина  устанавливается  в  0
                (имеет  смысл только если файл уже существо-
                вал).

       OO__EEXXCCLL   (02000) При  указании  совместно  с  режимом
                OO__CCRREEAATT  и  при  уже существующем файле ooppeenn
                возвращает  ошибку  [[EEEEXXIISSTT]]   (без   режима
                OO__CCRREEAATT не имеет смысла). Режим OO__EEXXCCLL можно
                трактовать как режим  монопольного  открытия
                файла.  Например, если при операции открытия
                файла указать режимы  OO__EEXXCCLL  и  OO__CCRREEAATT,  в
                параметре _m_o_d_e указать нулевые режимы созда-
                ния файла, и ooppeenn завершится  нормально,  то
                гарантируется,  что  этот  файл  будет вновь
                создан и ни один процесс его не сможет  отк-
                рыть.

       При открытии указатель чтения/записи  устанавливается
       на начало файла (если не указан режим OO__AAPPPPEENNDD).

ЗЗННААЧЧЕЕННИИЕЕ
       В случае успешного завершения возвращается дескриптор
       открытого  файла,  иначе - значение -1 и в переменную
       eerrrrnnoo записывается код ошибки.

ККООДДЫЫ ООШШИИББООКК
       При неудачном завершении переменная eerrrrnnoo может  при-
       нимать следующие значения:

       [[EENNXXIIOO]]     Указанный файл является внешним устройст-
                   вом,  которое в данный момент не готово к
                   работе. См. режим OO__NNDDEELLAAYY.

       [[EEAACCCCEESS]]    Режим доступа указанного файла  не  соот-
                   ветствует запросу.

       [[EEFFAAUULLTT]]    Адрес параметра системного вызова выходит
                   за  границы  адресного  пространства про-
                   цесса.

       [[EEEEXXIISSTT]]    При создании файла файл уже существует.

       [[EENNOOTTDDIIRR]]   Указанное имя содержит компоненту,  кото-
                   рая не является каталогом.



                            -2-                      ДЕМОС/P


OPEN(2)           ДЕМОС. Системные вызовы            OPEN(2)


       [[EEIISSDDIIRR]]    Попытка открыть на запись каталог.

       [[EEIINNVVAALL]]    Указанн неверный аргумент.

       [[EEMMFFIILLEE]]    Переполнена таблица дескрипторов открытых
                   файлов процесса.

       [[EETTXXTTBBSSYY]]   Попытка открыть на запись файл,  содержа-
                   щий   загрузочный   модуль  выполняющейся
                   реентерабельной программы.

       [[EERROOFFSS]]     Указанный файл содержится в файловой сис-
                   теме, закрытой по записи, и не может быть
                   модифицирован.

       [[EELLOOOOPP]]     Число косвенных ссылок в указанном  имени
                   превышает  максимально  допустимое значе-
                   ние.

ДДООППООЛЛННИИТТЕЕЛЛЬЬННЫЫЕЕ ССССЫЫЛЛККИИ
       _c_l_o_s_e(2),  _c_r_e_a_t(2),  _d_u_p(2),   _i_o_c_t_l(2),   _l_s_e_e_k(2),
       _r_e_a_d(2), _u_m_a_s_k(2), _w_r_i_t_e(2).






































                            -3-                      ДЕМОС/P

