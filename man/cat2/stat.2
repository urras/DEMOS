
STAT(2)           ДЕМОС. Системные вызовы            STAT(2)


ИИММЯЯ
       ssttaatt, llssttaatt, ffssttaatt - получение информации о файле.

ФФООРРММААТТ
       #iinncclluuddee <_s_y_s/_t_y_p_e_s._h>
       #iinncclluuddee <_s_y_s/_s_t_a_t._h>

       ssttaatt (_n_a_m_e, _b_u_f)
       cchhaarr **_n_a_m_e;
       ssttrruucctt ssttaatt **_b_u_f;

       llssttaatt (_n_a_m_e, _b_u_f)
       cchhaarr **_n_a_m_e;
       ssttrruucctt ssttaatt **_b_u_f;

       ffssttaatt (_f_d, _b_u_f)
       iinntt _f_d;
       ssttrruucctt ssttaatt **_b_u_f;

ООППИИССААННИИЕЕ
       Системный вызов  ssttaatt  позволяет  получать  подробную
       информацию  об  указанном  файле.  При этом не важно,
       имеет ли данный  процесс  право  читать,  писать  или
       выполнять   данный  файл.  Однако  необходимо,  чтобы
       существовали и были доступны все каталоги, ведущие  к
       файлу.

       Системный вызов llssttaatt выполняет действия, аналогичные
       ssttaatt, с тем исключением, что если указанное имя явля-
       ется символической ссылкой, информация выдается не  о
       файле, а о самой ссылке.

       ffssttaatt предоставляет ту же самую информацию об  откры-
       том файле, при этом указывается не имя файла, а соот-
       ветствующий ему дескриптор.

       Параметр _b_u_f является адресом буфера, в который поме-
       щается информация, имеющая следующую структуру:

       ssttrruucctt ssttaatt
       {  /* Положение i-узла устройства */
               ddeevv__tt   sstt__ddeevv;
          /* Номер i-узла данного файла */
               iinnoo__tt   sstt__iinnoo;
          /* Статус файла */
               uu__sshhoorrtt sstt__mmooddee;
          /* Число прямых ссылок на файл */
               sshhoorrtt   sstt__nnlliinnkk;
          /* ID владельца файла */
               sshhoorrtt   sstt__uuiidd;
          /* ID группы владельца файла */
               sshhoorrtt   sstt__ggiidd;
          /* Тип устройства */
               ddeevv__tt   sstt__rrddeevv;
          /* Размер файла */
               ooffff__tt   sstt__ssiizzee;
          /* Время последнего обращения */
               ttiimmee__tt  sstt__aattiimmee;


                            -1-                      ДЕМОС/P


STAT(2)           ДЕМОС. Системные вызовы            STAT(2)


          /* Время последней модификации */
               ttiimmee__tt  sstt__mmttiimmee;
          /* Время последнего изменения статуса */
               ttiimmee__tt  sstt__ccttiimmee;
       };

       sstt__aattiimmee  Время  последнего  доступа  к  файлу.   Эта
                 переменная  изменяется  при выполнении сис-
                 темных вызовов: _m_k_n_o_d(2), _u_t_i_m_e(2), _r_e_a_d(2)
                 и  _w_r_i_t_e(2).  По соображениям эффективности
                 sstt__aattiimmee не изменяется при поиске  в  ката-
                 логе, хотя это было бы логично.

       sstt__mmttiimmee  Время последней модификации данных.   Пере-
                 менная  не  изменяется при смене владельца,
                 группы, числа ссылок  или  режимов  доступа
                 файла.   Новое  значение  sstt__mmttiimmee получает
                 при выполнении системных вызовов  _m_k_n_o_d(2),
                 _u_t_i_m_e(2), _w_r_i_t_e(2).

       sstt__ccttiimmee  Время последнего изменения  статуса  файла.
                 Переменная  изменяется и при записи в файл.
                 Новое значение sstt__ccttiimmee получает при выпол-
                 нении системных вызовов _c_h_m_o_d(2), _c_h_o_w_n(2),
                 _l_i_n_k(2),  _m_k_n_o_d(2),  _u_n_l_i_n_k(2),   _u_t_i_m_e(2),
                 _w_r_i_t_e(2).  Переменная sstt__mmooddee содержит ста-
                 тус файла, который составляется из  следую-
                 щих признаков:

  /* Тип файла */
  #ddeeffiinnee SS__IIFFMMTT   0170000 /* Общая маска на тип */
  #ddeeffiinnee SS__IIFFIIFFOO  0010000 /* FFIIFFOO файл */
  #ddeeffiinnee SS__IIFFCCHHRR  0020000 /* Специальный типа _c */
  #ddeeffiinnee SS__IIFFDDIIRR  0040000 /* Каталог */
  #ddeeffiinnee SS__IIFFBBLLKK  0060000 /* Специальный типа _b */
  #ddeeffiinnee SS__IIFFRREEGG  0100000 /* Обычный файл */
  #ddeeffiinnee SS__IIFFLLNNKK  0120000 /* Косвенная ссылка */
  #ddeeffiinnee SS__IIFFQQUUOOTT 0140000 /* Специальный типа _q */
  /* Режимы выполнения */
  #ddeeffiinnee SS__IISSUUIIDD  0004000 /* Выполняется в режиме */
                           /* sseett--UUIIDD */
  #ddeeffiinnee SS__IISSGGIIDD  0002000 /* Выполняется в режиме */
                           /* sseett--GGIIDD */
  #ddeeffiinnee SS__IISSVVTTXX  0001000 /* Остается в области */
                           /* подкачки - если файл. */
                           /* Уничтожение файла только */
                           /* при праве записи - */
                           /* если каталог */
  /* Режим доступа для владельца файла */
  #ddeeffiinnee SS__IIRREEAADD  0000400 /* Доступен для чтения */
  #ddeeffiinnee SS__IIWWRRIITTEE 0000200 /* Доступен для записи */
  #ddeeffiinnee SS__IIEEXXEECC  0000100 /* Доступен для выполнения */

       Поля  0000070  и  0000007  соответственно  определяют
       режим доступа для группы и остальных пользователей.

ЗЗННААЧЧЕЕННИИЕЕ
       Если можно  получить  состояние  файла,  возвращается


                            -2-                      ДЕМОС/P


STAT(2)           ДЕМОС. Системные вызовы            STAT(2)


       ноль; если файл не найден, возвращается -1.

ККООДДЫЫ ООШШИИББООКК
       При неудачном завершении ssttaatt  или  llssttaatt  переменная
       eerrrrnnoo может принимать следующие значения:

       [EENNOOTTDDIIRR]   Указанное имя содержит компоненту,  кото-
                   рая не является каталогом.

       [EENNOOEENNTT]    Задано слишком  длинное  или  пустое  имя
                   файла. Указанный файл не существует.

       [EEAACCCCEESS]    Какой-либо из каталогов, входящих  в  имя
                   файла, не доступен для просмотра.

       [EEFFAAUULLTT]    Адреса аргументов системного вызова выхо-
                   дят  за границы памяти, доступной данному
                   процессу.

       [EELLOOOOPP]     Число косвенных ссылок в указанном  имени
                   превышает  максимально  допустимое значе-
                   ние.

       При неудачном завершении ffssttaatt переменная eerrrrnnoo может
       принимать следующие значения:

       [EEFFAAUULLTT]    Адреса аргументов системного вызова выхо-
                   дят  за границы памяти, доступной данному
                   процессу.

       [EEBBAADDFF]     Значение _f_d не соответствует  дескриптору
                   открытого файла.

ДДООППООЛЛННИИТТЕЕЛЛЬЬННЫЫЕЕ ССССЫЫЛЛККИИ
       _c_h_m_o_d(2), _c_h_o_w_n(2), _u_t_i_m_e(2)

























                            -3-                      ДЕМОС/P

