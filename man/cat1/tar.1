
TAR(1)                 ДЕМОС. Команды                 TAR(1)


ИИММЯЯ
        ttaarr - работа с ленточным архивом.

ФФООРРММААТТ
        ttaarr _к_л_ю_ч [_и_м_я ...]

ООППИИССААННИИЕЕ
        Команда ttaarr предназначена для выполнения всех  видов
        работ  с материалами, записанными в архивном формате
        (формат ttaarr).  Обычно архивы в формате ttaarr использу-
        ются  для  хранения  и транспортировки информации на
        магнитных  лентах  и  флоппи-дисках.   Режим  работы
        команды  задается  с  помощью  аргумента _к_л_ю_ч.  _К_л_ю_ч
        состоит из  символа,  указывающего  тип  выполняемой
        операции (запись, чтение, выдача каталога и т.п.) и,
        возможно, символов  определяющих  режимы  выполнения
        данной  операции.  _К_л_ю_ч является первым и обязатель-
        ным параметром, за которым может следовать  уточняю-
        щая  информация (если этого требует указанный режим)
        и имена обрабатываемых файлов и каталогов.

        ttaarr выполняет следующие операции:

        cc       Создает новый архив на ленте и перечисленные
                файлы  записываются в него (запись ведется с
                начала файла, а не в конец архива).

        CC       Перечисленные файлы на ленте сравниваются  с
                имеющимимся.

        rr       Перечисленные файлы дописываются в архив  на
                ленте (запись ведется в конец архива).

        tt       Имена указанных файлов выдаются каждый  раз,
                когда  они  встречаются в архиве. Если имена
                не заданы, выдаются  имена  всех  файлов  на
                ленте (выдача каталога).

        xx       Перечисленные  файлы  считываются  с  ленты.
                Если  задано  имя каталога, считывается этот
                каталог (т.е. все файлы начинающиеся с  ука-
                занного  имени).   Владелец  и статус файлов
                сохраняется (если  это  возможно).  Если  не
                задается  ни  одного аргумента _и_м_я, считыва-
                ются все файлы с ленты.  Если на ленте  име-
                ется несколько файлов с одинаковыми именами,
                считываются все варианты  файла  и  остается
                последний.

        XX       Чтение файлов с ленты со сравнением с  имею-
                щимися   в  указанном  каталоге.   Совпавшие
                файлы  связываются  ссылками,  не  совпавшие
                записываются.

        Следующие  символы  определяют  режимы  работы   при
        выполнении операции:

        aa       Перечисленные файлы ищутся и считываются  из


                            -1-                      ДЕМОС/P


TAR(1)                 ДЕМОС. Команды                 TAR(1)


                всех архивов на ленте.

        BB       Заставляет команду ttaarr трактовать  следующий
                аргумент   как   объем   устройства  (обычно
                флоппи-диска) в килобайтах.  После того, как
                на  объем информации превысит указанный, ttaarr
                просит сменить флоппи-диск,  и  после  ввода
                символа  <_п_е_р_е_в_о_д _с_т_р_о_к_и> продолжает запись.
                Этот режим служит для записи больших архивов
                на несколько гибких дисков (обычно использу-
                ется на персональных ЭВМ).

        SS       Заставляет команду ttaarr трактовать  следующий
                аргумент как объем ленты в килобайтах. После
                того, как на объем информации на ленте  пре-
                высит указанный, ttaarr просит сменить ленту, и
                после ввода символа <_п_е_р_е_в_о_д _с_т_р_о_к_и> продол-
                жает  запись.  Этот  режим служит для записи
                больших архивов на несколько лент.

        bb       Заставляет команду ttaarr использовать  следую-
                щий  аргумент в качестве коэффициента блоки-
                рования записей на ленте.  По  умолчанию  он
                равен  20,  максимальное  значение равно 32.
                Этот ключ следует  использовать  только  для
                архивов на магнитной ленте типа /_d_e_v/*_r_m_t*.

        ff       Заставляет команду ttaarr использовать  следую-
                щий  аргумент в качестве имени архива вместо
                /_d_e_v/_n_r_m_t_0.  Если именем файла  служит  "--",
                ttaarr  пишет  в  стандартный  файл вывода (или
                читает из стандартного файла  ввода).   Пос-
                леднее   свойство   позволяет   использовать
                команду ttaarr  при  конструировании  составных
                команд.   Например, для копирования каталога
                _f_r_o_m  в  каталог  _t_o  можно  воспользоваться
                командой:

                ccdd _f_r_o_m; ttaarr ccff -- . | (ccdd _t_o; ttaarr xxff --)

        ii       При чтении:

                Заставляет  продолжать  работу  при  ошибках
                чтения  ленты  или  несовпадении контрольной
                суммы  заголовка,  это  позволяет,  начинать
                чтение  с  архивной  ленты  с середины.  При
                ошибке  делается  попытка  найти   следующий
                заголовок файла и продолжить работу.

                При записи:

                Если зарегистрирована ошибка, запись продол-
                жается,  но несколько последних файлов запи-
                сываются повторно.   Если  лента  кончилась,
                выдается  запрос  на смену ленты, после чего
                запись продолжается с повторением нескольких
                последних файлов.



                            -2-                      ДЕМОС/P


TAR(1)                 ДЕМОС. Команды                 TAR(1)


        hh       Косвенные ссылки обрабатываются как если  бы
                они были обычными каталогами или файлами.

        ll       Провоцирует выдачу сообщений  при  невозмож-
                ности  разрешить все связи восстанавливаемых
                файлов. Если этот ключ не  задан,  сообщения
                об таких ошибках не печатаются.

        mm       При чтении  время  и  дата  создания  файлов
                устанавливается  по  значениям,  указанным в
                архиве.

        dd       При чтении файлов с  ленты  в  случае,  если
                лента  записывалась в другой кодировке пере-
                кодировать текстовые файлы (из U-кода  (если
                система работает в КОИ-8) или из КОИ-8 (если
                система работает в U-коде).  Файл  считается
                текстовым,  если  в  первых 512 символах нет
                нетекстовых символов.

        DD       То же, что и dd, но без проверки на  несовпа-
                дение  кодировок  в системах, в которых осу-
                ществлялась запись и чтение информации.

        oo       Блокировать выдачу диагностики  о  невозмож-
                ности создания файла при чтении.

        pp       Чтение файлов с сохранением принадлежности и
                режимов спецвыполнения.

        ss       При вызове  программы  ttaarr  указывается  имя
                файла,  в котором находится список имен фай-
                лов для обработки.  Если вместо имени  файла
                указан  символ "--", список имен файлов будет
                читается из стандартного файла ввода.

        uu       Перечисленные файлы дописываются в архив  на
                ленте,  только  если  их там не было или они
                менялись   с   момента   предыдущей   записи
                (используется вместе с режимом rr).

        00, ..., 99
                Работа    с    архивом     на     устройстве
                /_d_e_v/_n_r_m_t[0-9].

        vv       Для каждого из обрабатываемых  файлов  выда-
                ется его имя и символ соответствующий выпол-
                няемой операции.  В случае операции tt, выда-
                ются  не  только имена файлов на ленте, но и
                другая информация (размер, владелец,  режимы
                доступа и т.д.).

        ww       Перед выполнением  операции  над  каждым  из
                файлов  печатается  его  имя и запрашивается
                подтверждение.  Возможны следующие  варианты
                ответа:

                yy    - выполнить действие,


                            -3-                      ДЕМОС/P


TAR(1)                 ДЕМОС. Команды                 TAR(1)


                nn    - пропустить действие,

                ==_и_м_я - выполнить действие  без  запроса  для
                     всех  файлов,  имена  которых совпадают
                     или начинаются с _и_м_я,

                ##_и_м_я - пропустить файлы, имена которых  сов-
                     падают или начинаются с _и_м_я.

        //       При чтении с ленты файлы,  заданные  полными
                именами (т.е. с именами начинающимися симво-
                лом //) записываются в текуший  каталог,  при
                этом  начальный символ // в порождаемом имени
                опускается.

        Архив на ленте состоит из логических блоков  по  512
        байт (возможно, сблокированных в более длинные физи-
        ческие записи). Файлы занимают целое число  записей,
        каждому    файлу   предшествует   логический   блок-
        заголовок.  Весь архив записывается одним физическим
        файлом  на  ленте.   Дозапись в сблокированный архив
        возможна при использовании драйвера _t_m(4) для работы
        с лентами.

ФФААЙЙЛЛЫЫ
        /_d_e_v/*_m_t*   спецфайл ленты
        /_t_m_p/_t_a_r*   рабочий файл, создаваемый программой.

ДДИИААГГННООССТТИИККАА
        Сообщения о неправильных ключевых символах и ошибках
        чтения/записи.

        Сообщения о недостатке памяти  для  хранения  таблиц
        связи.

ЗЗААММЕЕЧЧААННИИЯЯ
        Отсутствует  возможность  запроса  _n-ого   появления
        файла.

        Операция uu  может  потребовать  значительных  затрат
        времени.

        Ключ hh можно использовать, только если нет косвенных
        ссылок на каталоги.
















                            -4-                      ДЕМОС/P

